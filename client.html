<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>RPC example</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js" type="text/javascript"></script>
    <script type = "text/javascript">
    $(document).ready(function(){
        const ip = 'http://192.168.0.114:8000/vote';
        // var k = $('.vote').val();
        // var data = {name:k};
        var k,data
        $("select.vote").change(function(){
         k = $(this).children("option:selected").val();
         data = k;
        });
        

        $('.s-v').click(function(){
            $.ajax({
                url : ip,
                type : "POST",
                dataType: "jsonp",
                 headers: { 
                             "Accept": "application/json",
                           },
                 contentType: "application/json",
                 dataType : 'json', // data type
                data : data,
                crossDomain: true,
                beforeSend: function(){
                  console.log("ajax call");
                },
                success : function(result){
                    console.log(result.responseText);
                    $('.response').text(error.responseText)
                },
                error:function(error){
                   // var res = JSON.stringify(error);
                    console.log(error.responseText);
                    $('.response').text(error.responseText)
                }
            })
        })
    })
    </script>
    <script>
      $(document).ready(function(){
        const ip = 'http://192.168.0.114:8000/results';
        $('.results').click(function(){
            $.ajax({
                url : ip,
                type : "GET",
                dataType: "jsonp",
                 headers: { 
                             "Accept": "application/json",
                           },
                 contentType: "application/json",
                 dataType : 'json', // data type
                crossDomain: true,
                beforeSend: function(){
                  console.log("gETTING RESULTS");
                },
                success : function(result){
                    console.log(result.responseText);
                    $('.result-response').text(error.responseText)
                },
                error:function(error){
                   // var res = JSON.stringify(error);
                    console.log(error.responseText);
                    $('.result-response').text(error.responseText)
                }
            })
        })
    })
    </script>
  </head>

  <body>
    <form id="form" name = "f">
      Select Candidate: 
      <select name="vote" class="vote">
        <option value="">--SELECT--</option>
          <option value="modi">Modi</option>
          <option value="kejriwal">kejriwal</option>
          <option value="rahul">rahul</option>
      </select>
      <button type = "button" class = "s-v">Vote</button>
      <p class ="response">
      </p>
      <br><br><br>
      <hr>
      <button type = "button" class = "results">Get results</button>
      <p class = "result-response"></p>
    </form>
  </body>
</html>
